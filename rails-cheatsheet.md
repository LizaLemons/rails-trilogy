
# Rails Cheatsheet

---

## Part I - Creating a new Rails app

---


#### Creating a new Rails app
- Create new app: `rails new <app_name>`
- CD into new rails app
- `rails server`
- Navigate to `localhost:3000`
- Make sure you see the happy people :D


---


#### Require any gems in Gemfile

```rb
gem 'pry-rails'
gem 'awesome_print'
# etc.
```

- `bundle install`
- Anytime you make changes to gemfile, `bundle install`




---

## Part II - Routes, Controllers, Views

---


#### Routes
- Routes live in `config/routes.rb`
- Verb + path = route
- Routes look like this:
  - `get   "/about-us"    =>    "welcome#about_us"`


---


#### Create Controllers
- Each route corresponds to a method in a controller
- The command `rails generate controller <ControllerName>` creates controller files for you
- If you mess up: `rails destroy controller <ControllerName>`
- `ControllerName` is always plural and ProperCase. Examples:
  - `rails generate controller Welcome` (singular; this is the exception)
  - `rails generate controller Cowboys`
  - `rails generate controller Users`
- However, the generated controller files will be `snake_case` and plural (`cowboys_controller.rb`) (the exception is `application_controller.rb`, which is autogenerated).


---


#### Write methods in Controllers
Controllers contain methods. Methods look like this:

```ruby
def about_us
  @message = "This is the About Us page."
end
```

The method names **must** correspond with what we wrote in our route.


---


#### Create some Views

- All routes have corresponding methods in the corresponding controller. However, not all methods have corresponding views.
- `touch` a few `html.erb` files in the correct Views dir.
- For example, the `index` method of the `cowboys` Controller will have the corresponding view file: `/app/views/index.html.erb`


---


#### Something to see in your views

- If you have a `@message` in your controller method, display it in your corresponding view like so:

```erb
<%= @message %>
```

- Now we can see our message in the browser!


---

## Part III - Models, Active Record, DB

---


#### Models

The command `rails generate model <ModelName>` creates migration **and** model files for you all in one step.

`ModelName` is always singular and ProperCase.

Examples:
- `rails generate model Todo`
- `rails generate model Cowboy`

If you mess up:
- `rails destroy model Cowboy`

Note that we don't need to generate a model for `Welcome` because it is not an "entity" in our app (something we CRUD). It therefore does not need a table in our DB.


---


#### Creating models + column names at the same time

Examples:
- `rails generate model Unicorn name:string tail_color:string`
- `rails generate model User name:string age:integer`


---


#### Rake your migration files

After you create models, you can run migrations:
- `rails db:migrate`

Sweet! Check out your `db/schema.rb` file.


---


#### Seed file

In the previous command, you created your schema. When you create a model & specify column names & types, under the hood you are creating the schema.

Now that we have our schema, we can create some dummy data in the `db/seeds.rb` file.

Data will be in hash format.

```ruby
Cowboy.create([
  { name: "Billy the Kid", city: "New York City", age: 13},
  { name: "Will Rogers", city: "Oologah", age: 55},
  { name: "Jesse James", city: "Kearney", age: 77}
])
```

Now run `rails db:seed`


---


#### DB console
- `rails console`

Now you can do things like:
- See all Cowboys: `Cowboy.all`
- Create some new Cowboys with `.create()`


---

## Part IV - Accessing DB info in Controllers & Views

---


#### DB info in Controllers

- Now that we've seeded our DB with some cowboys, I can access them in my Cowboys Controller
- In the Index method, for example, I want to see **all** cowboys:

```ruby
def index
  @cowboys = Cowboy.all
end
```


---


#### Making this info appear in Views

- Now in the corresponding Cowboys Index View, I can display this info like so:

```erb
<% @cowboys.each do |cowboy| %>
  <%= cowboy.id %>.
  <%= cowboy.name %> •
  <%= cowboy.city %> •
  <%= cowboy.age %>
  <br><br>
<% end %>
```


---


## Done!


---


#### Some FYI stuff:


---


#### DB oops stuff

If you need to make changes to schema later:
- Option 1: run `rails db:drop db:create db:migrate`
- Option 2: run `rails db:reset` and `rails db:migrate`
- Option 3: create new migration file

The command `rails db:reset` is a combo of the following commands:
- `rails db:drop db:create db:schema:load db:seed`


---


#### When you pull someone else's rails app
- If this is someone else's project, make sure you run `bundle install`
  - This reads the `gemfile` & installs the necessary gems.
- Create the DB, migrate your tables & seed the db. This reads from their `database.yml` file for a DB name (if none, it'll name the DB after the name of the app).
  - `rails db:create`
  - `rails db:migrate`
  - `rails db:seed`
- From root dir of project, run `rails server`






#
